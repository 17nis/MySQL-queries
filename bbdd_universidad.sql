use universidad;
SELECT apellido1, apellido2, nombre FROM universidad.persona order by apellido1 desc, apellido2 desc;
SELECT nombre, apellido1, apellido2 FROM universidad.persona where telefono is NULL;
SELECT * FROM universidad.persona where fecha_nacimiento >= '1999-01-01' and fecha_nacimiento <= '1999-12-31';
SELECT nombre, apellido1, apellido2, nif, tipo FROM universidad.persona where telefono is NULL and tipo = 'profesor' and nif regexp 'K$';
SELECT * FROM universidad.asignatura where cuatrimestre = 1 and curso = 3 and id_grado = 7;
SELECT  apellido1, apellido2, persona.nombre, departamento.nombre as departamento FROM universidad.profesor inner join universidad.persona on profesor.id_profesor = persona.id inner join universidad.departamento on profesor.id_departamento = departamento.id  order by apellido1 asc, apellido2 asc, persona.nombre asc;
SELECT persona.nombre, apellido1, apellido2, asignatura.nombre, anyo_inicio, anyo_fin FROM universidad.alumno_se_matricula_asignatura al join universidad.persona  on al.id_alumno =  persona.id join universidad.curso_escolar on al.id_curso_escolar = curso_escolar.id join universidad.asignatura on al.id_asignatura = asignatura.id where persona.nif = '26902806M'; 
SELECT distinct profesor.id_departamento FROM universidad.asignatura join universidad.grado on asignatura.id_grado = grado.id join universidad.profesor on asignatura.id_profesor = profesor.id_profesor  where grado.id = 4;
SELECT distinct persona.nombre, apellido1, apellido2, anyo_inicio, anyo_fin FROM universidad.alumno_se_matricula_asignatura al join universidad.persona  on al.id_alumno =  persona.id join universidad.curso_escolar on al.id_curso_escolar = curso_escolar.id join universidad.asignatura on al.id_asignatura = asignatura.id where anyo_inicio = 2018; 
SELECT departamento.nombre as departamento, apellido1, apellido2, persona.nombre FROM universidad.profesor right join universidad.persona on profesor.id_profesor = persona.id left join universidad.departamento  on profesor.id_departamento = departamento.id order by departamento desc, apellido1 desc;
SELECT departamento.nombre as departamento, apellido1, apellido2, persona.nombre FROM universidad.profesor right join universidad.persona on profesor.id_profesor = persona.id left join universidad.departamento  on profesor.id_departamento = departamento.id where profesor.id_departamento is null order by departamento desc, apellido1 desc;
SELECT departamento.nombre as 'departamento sin profe' FROM universidad.profesor right join universidad.departamento  on profesor.id_departamento = departamento.id where profesor.id_departamento is null order by departamento.nombre desc;
SELECT persona.nombre as 'profesor sin asignatura'  FROM universidad.persona left join universidad.asignatura  on persona.id = asignatura.id_profesor left join universidad.profesor on persona.id = profesor.id_profesor where asignatura.id_profesor is null and persona.tipo = 'profesor'; 
SELECT asignatura.nombre as 'asignatura sin profe'  FROM universidad.asignatura  left join universidad.profesor  on asignatura.id_profesor = profesor.id_profesor  where asignatura.id_profesor is null order by asignatura.nombre asc; 
SELECT distinct departamento.nombre as 'departamento sin impartir asignaturas'  FROM universidad.profesor  right join universidad.departamento  on profesor.id_departamento = departamento.id left join universidad.asignatura on profesor.id_profesor = asignatura.id_profesor where asignatura.id_profesor is null order by departamento.nombre;
SELECT count(persona.id) FROM universidad.persona where persona.tipo = 'alumno';
SELECT count(persona.id) FROM universidad.persona where persona.fecha_nacimiento >= '1999-01-01' and persona.fecha_nacimiento <= '1999-12-31';
SELECT departamento.nombre, count(profesor.id_profesor) FROM universidad.profesor  join universidad.departamento on profesor.id_departamento = departamento.id group by departamento.nombre order by count(profesor.id_profesor) desc ;
SELECT grado.nombre, count(asignatura.id_grado) FROM universidad.asignatura right join universidad.grado on asignatura.id_grado = grado.id group by (grado.id) order by count(asignatura.id_grado) desc;
SELECT grado.nombre, count(asignatura.id_grado) FROM universidad.asignatura right join universidad.grado on asignatura.id_grado = grado.id  group by (grado.id) having count(asignatura.id_grado) > 40 ;